<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Shadowverse Custom Card Generator</title>

  <!-- Cropper.js (required by your script) -->
  <link rel="stylesheet" href="https://unpkg.com/cropperjs/dist/cropper.min.css">
  <script src="https://unpkg.com/cropperjs/dist/cropper.min.js"></script>

  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* ---------- Overall layout ---------- */
    :root{
      --bg:#0d0d0d;
      --panel:#141414;
      --muted:#9aa0a6;
      --accent:#00bcd4;
      --input:#1b1b1b;
      --card-bg:#111;
      --control-width:420px;
    }
    html,body{
      height:100%;
      margin:0;
      background:var(--bg);
      color:#eee;
      font-family: Inter, Roboto, "Helvetica Neue", Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    header{
      text-align:center;
      padding:28px 20px 8px;
    }
    header h1{
      margin:0;
      font-size:22px;
      letter-spacing:0.4px;
      font-weight:700;
    }
    header p{
      margin:6px 0 0;
      color:var(--muted);
      font-size:12px;
    }

    main.app {
      display:flex;
      gap:28px;
      padding:20px;
      justify-content:center;
      align-items:flex-start;
    }

    /* left column: controls */
    .left {
      width:var(--control-width);
      display:flex;
      gap:16px;
      flex-direction:column;
    }

    .panel {
      background:linear-gradient(180deg,#111 0%, #0f0f0f 100%);
      border-radius:12px;
      padding:16px;
      box-shadow:0 6px 18px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.03);
    }

    .row {
      display:flex;
      gap:12px;
      align-items:center;
      margin-bottom:8px;
      flex-wrap:wrap;
    }

    label.small {
      display:block;
      color:var(--muted);
      font-size:13px;
      margin-bottom:6px;
    }

    input[type="text"], input[type="number"], select, textarea {
      width:100%;
      background:var(--input);
      color:#eaeaea;
      border-radius:6px;
      border:1px solid rgba(255,255,255,0.04);
      padding:8px 10px;
      box-sizing:border-box;
      font-size:14px;
    }

    textarea { min-height:100px; resize:vertical; }

    .controls-grid {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      align-items:center;
    }

    .btn {
      appearance:none;
      border:0;
      background:var(--accent);
      color:#042;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
    }
    .btn.secondary { background:#2b2b2b; color:#ddd; border:1px solid rgba(255,255,255,0.03); }

    .small-btn {
      padding:6px 8px;
      font-size:13px;
      border-radius:6px;
    }

    .checkbox {
      display:flex;
      gap:8px;
      align-items:center;
      color:var(--muted);
      font-size:13px;
    }

    /* right column: text fields */
    .right {
      width:520px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .field-title {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .field-title .title {
      font-weight:700;
      color:#f3e8c9;
      font-size:13px;
    }
    .field-title .subtitle {
      color:var(--muted);
      font-size:12px;
    }

    /* preview */
    .preview-wrap {
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:12px;
      margin-left:12px;
    }

    canvas#previewCanvas {
      width:960px;
      height:540px;
      max-width:100%;
      background:var(--card-bg);
      border-radius:10px;
      box-shadow:0 10px 40px rgba(0,0,0,0.7);
      border:1px solid rgba(255,255,255,0.03);
    }

    .footer {
      margin-top:14px;
      color:var(--muted);
      font-size:13px;
      text-align:center;
    }

    /* small helpers */
    .muted { color:var(--muted); font-size:13px; }
    .inline { display:flex; gap:8px; align-items:center; }
    .hidden { display:none !important; }
    .upload-note { font-size:12px; color:var(--muted); margin-top:8px; }

    /* modal cropper styling (basic) */
    .modal {
      position:fixed;
      inset:0;
      background:rgba(0,0,0,0.65);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9999;
      padding:20px;
    }
    .modal .box {
      background:#0f0f0f;
      padding:14px;
      border-radius:10px;
      max-width:90%;
      width:720px;
      box-shadow:0 10px 40px rgba(0,0,0,0.7);
      border:1px solid rgba(255,255,255,0.03);
    }
    .modal .actions { display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }
    .modal img { max-width:100%; display:block; border-radius:6px; }
  </style>
</head>
<body>
  <header>
    <h1>Shadowverse Custom Card Generator</h1>
    <p>V1.6.0 — Live preview is active. Use Chrome/Firefox for best results.</p>
  </header>

  <main class="app">
    <!-- left side: controls -->
    <div class="left">
      <div class="panel">
        <div class="row">
          <button id="generateCard" class="btn">Generate card</button>
          <!-- main art upload input (script expects #artUpload) -->
          <input id="artUpload" type="file" accept="image/*" style="display:none;">
          <button id="uploadArt" class="btn secondary small-btn" onclick="document.getElementById('artUpload').click()">Upload Image</button>
          <span class="muted" id="fileStatus">No file selected.</span>
        </div>

        <label class="small">Name</label>
        <input id="cardName" type="text" placeholder="Card name">

        <label class="small">Trait</label>
        <input id="cardTrait" type="text" placeholder="Trait">

        <div class="controls-grid" style="margin-top:8px;">
          <div>
            <label class="small">Class</label>
            <select id="cardClass">
              <option>Neutral</option>
              <option>Forestcraft</option>
              <option>Swordcraft</option>
              <option>Runecraft</option>
              <option>Dragoncraft</option>
              <option>Abysscraft</option>
              <option>Havencraft</option>
              <option>Portalcraft</option>
            </select>
          </div>

          <div>
            <label class="small">Type</label>
            <select id="cardType">
              <option>Follower</option>
              <option>Spell</option>
              <option>Amulet</option>
            </select>
          </div>

          <div>
            <label class="small">Rarity</label>
            <select id="cardRarity">
              <option>Bronze</option>
              <option>Silver</option>
              <option>Gold</option>
              <option selected>Legendary</option>
            </select>
          </div>

          <div>
            <label class="small">Cost</label>
            <input id="costValue" type="number" min="0" value="0">
          </div>
        </div>

        <div style="margin-top:10px;">
          <label class="small">Un-evolved Attack / Defense</label>
          <div class="row">
            <input id="attackValue" type="number" placeholder="Attack" style="width:48%" />
            <input id="defenseValue" type="number" placeholder="Defense" style="width:48%" />
          </div>
        </div>

        <label class="small" style="margin-top:10px">Illustrator</label>
        <input id="illustratorName" type="text" placeholder="Illustrator name">

        <div style="display:flex; gap:10px; margin-top:12px; align-items:center;">
          <label class="checkbox"><input id="tokenCheckbox" type="checkbox"> Token card</label>
          <label class="checkbox"><input id="wordCountCheckbox" type="checkbox"> Show word count</label>
        </div>

        <p class="upload-note">Tip: click the Upload Image button to crop main art (450×560).</p>
      </div>

      <!-- optional small panel for attack/defense evolved etc (keeps compatibility) -->
      <div class="panel" style="margin-top:12px;">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <div class="muted">Evolved Attack</div>
            <input id="attackEvolved" type="number" style="width:140px" placeholder="Attack">
          </div>
          <div>
            <div class="muted">Evolved Defense</div>
            <input id="defenseEvolved" type="number" style="width:140px" placeholder="Defense">
          </div>
        </div>
      </div>
    </div>

    <!-- right side: text fields and preview -->
    <div style="display:flex; gap:18px; align-items:flex-start;">
      <div class="right">
        <div class="panel">
          <div class="field-title">
            <div class="title">Un-evolved Text</div>
            <div class="subtitle"><label><input id="boldCard" type="checkbox"> Bold keywords</label></div>
          </div>
          <textarea id="cardText" placeholder="Card text..."></textarea>
        </div>

        <div class="panel">
          <div class="field-title">
            <div class="title">Evolved Text</div>
            <div class="subtitle"><label><input id="boldEvolve" type="checkbox"> Bold keywords</label></div>
          </div>
          <textarea id="evolveText" placeholder="Evolve text..."></textarea>
        </div>

        <div class="panel">
          <div class="field-title">
            <div class="title">Super-Evolve Text</div>
            <div class="subtitle"></div>
          </div>
          <textarea id="superEvolveText" placeholder="Super-Evolve text..."></textarea>
        </div>

        <div class="panel">
          <div class="field-title">
            <div class="title">Crest Text</div>
            <div class="subtitle"><small class="muted">Upload crest icon appears when text present</small></div>
          </div>
          <textarea id="crestText" placeholder="Crest text..."></textarea>
          <!-- crest icon uploader (hidden by default; script toggles) -->
          <input id="crestArtUpload" type="file" accept="image/*" style="display:none;">
          <div style="margin-top:8px;">
            <button class="btn secondary small-btn" id="crestUploadBtn" onclick="document.getElementById('crestArtUpload').click()">Upload Crest Icon</button>
          </div>
        </div>

        <div class="panel">
          <div class="field-title">
            <div class="title">Faith Text</div>
            <div class="subtitle"><small class="muted">Upload faith icon appears when text present</small></div>
          </div>
          <textarea id="faithText" placeholder="Faith text..."></textarea>
          <input id="faithArtUpload" type="file" accept="image/*" style="display:none;">
          <div style="margin-top:8px;">
            <button class="btn secondary small-btn" id="faithUploadBtn" onclick="document.getElementById('faithArtUpload').click()">Upload Faith Icon</button>
          </div>
        </div>
      </div>

      <!-- preview column -->
      <div class="preview-wrap">
        <canvas id="previewCanvas" width="1920" height="1080"></canvas>
        <div class="footer">
          Live preview — edits update automatically.
        </div>
      </div>
    </div>
  </main>

  <!-- --- Cropper modals (main art, crest, faith) --- -->
  <div id="cropModal" class="modal hidden">
    <div class="box">
      <div style="font-weight:700; margin-bottom:6px;">Crop main art (450×560)</div>
      <img id="cropImage" alt="Crop image preview">
      <div class="actions">
        <button id="cropCancel" class="btn secondary">Cancel</button>
        <button id="cropConfirm" class="btn">Confirm</button>
      </div>
    </div>
  </div>

  <div id="crestCropModal" class="modal hidden">
    <div class="box">
      <div style="font-weight:700; margin-bottom:6px;">Crop crest icon (circle)</div>
      <img id="crestCropImage" alt="Crest crop preview">
      <div class="actions">
        <button id="crestCropCancel" class="btn secondary">Cancel</button>
        <button id="crestCropConfirm" class="btn">Confirm</button>
      </div>
    </div>
  </div>

  <div id="faithCropModal" class="modal hidden">
    <div class="box">
      <div style="font-weight:700; margin-bottom:6px;">Crop faith icon (circle)</div>
      <img id="faithCropImage" alt="Faith crop preview">
      <div class="actions">
        <button id="faithCropCancel" class="btn secondary">Cancel</button>
        <button id="faithCropConfirm" class="btn">Confirm</button>
      </div>
    </div>
  </div>

  <!-- script.js (your existing script) -->
  <script src="script.js"></script>

  <script>
    /* small glue: ensure modals use class hidden toggled by script (script.js manipulates style.display in examples) */
    // If your script relies on element.style.display, the above modals exist and have the same IDs.
    // Provide minimal event wiring for the upload button text status:
    const fileStatus = document.getElementById('fileStatus');
    const artUpload = document.getElementById('artUpload');
    const uploadArtBtn = document.getElementById('uploadArt');
    if (artUpload && fileStatus) {
      artUpload.addEventListener('change', () => {
        const f = artUpload.files[0];
        fileStatus.textContent = f ? f.name : 'No file selected.';
      });
    }
    // Hide crop modal DOM nodes by default (script.js may set display to block)
    document.querySelectorAll('.modal').forEach(m => m.style.display = 'none');
  </script>
</body>
</html>
